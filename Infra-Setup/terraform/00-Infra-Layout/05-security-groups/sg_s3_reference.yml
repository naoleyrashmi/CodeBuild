vpn_sg:                                         # name of security group, It will check for vpn_sg, db_sg and app_sg
  description: vpn sg
  sg_rules:                                     # array of rules needs to be added
  - rule_name: vpntcp                           # all these filelds need to be present
    description: Open VPN TCP
    type: ingress
    from_port: 443
    to_port: 443
    protocol: tcp
    cidr_blocks:
    - 0.0.0.0/0
  - rule_name: vpnssh
    description: Open VPN ssh
    type: ingress
    from_port: 22
    to_port: 22
    protocol: tcp
    cidr_blocks:
    - 0.0.0.0/0
  - rule_name: vpnudp
    description: Open VPN udp
    type: ingress
    from_port: 1194
    to_port: 1194
    protocol: udp
    cidr_blocks:
    - 0.0.0.0/0
  - rule_name: vpnhttp
    description: Open VPN http
    type: ingress
    from_port: 80
    to_port: 80
    protocol: udp
    cidr_blocks:
    - 0.0.0.0/0
  - rule_name: vpnegress                                # this rule is same as allow all ports for all protocols
    description: Open VPN egress
    type: egress
    from_port: 0
    to_port: 0
    protocol: -1
    cidr_blocks:
    - 0.0.0.0/0
app_sg:
  description: app sg
  sg_rules:
  - rule_name: apphttp
    description: WildFly Access
    type: ingress
    from_port: 80
    to_port: 80
    protocol: tcp
    source_sg: vpn_sg
  - rule_name: appLBhttp
    description: WildFly Access for LB
    type: ingress
    from_port: 80
    to_port: 80
    protocol: tcp
    source_sg: app_lb_sg
  - rule_name: apphttps
    description: WildFly Access
    type: ingress
    from_port: 443
    to_port: 443
    protocol: tcp
    source_sg: vpn_sg
  - rule_name: appLBhttps
    description: WildFly Access for LB
    type: ingress
    from_port: 443
    to_port: 443
    protocol: tcp
    source_sg: app_lb_sg
  - rule_name: applb
    description: Load Balancer
    type: ingress
    from_port: 8080
    to_port: 8080
    protocol: tcp
    source_sg: vpn_sg
  - rule_name: appsmptcp
    description: SMTP File Explorer
    type: ingress
    from_port: 135
    to_port: 139
    protocol: tcp
    source_sg: vpn_sg
  - rule_name: appsmpudp
    description: SMTP File Explorer
    type: ingress
    from_port: 135
    to_port: 139
    protocol: udp
    source_sg: vpn_sg
  - rule_name: appwildflyconsole
    description: WildFly Admin Console
    type: ingress
    from_port: 9990
    to_port: 9990
    protocol: tcp
    source_sg: vpn_sg
  - rule_name: appwildflyconsoleLB
    description: WildFly Admin Console for LB
    type: ingress
    from_port: 9990
    to_port: 9990
    protocol: tcp
    source_sg: app_lb_sg
  - rule_name: apprdp
    description: APP RDP
    type: ingress
    from_port: 3389
    to_port: 3389
    protocol: tcp
    source_sg: vpn_sg
  - rule_name: appself
    description: APP self call
    type: ingress
    from_port: 0
    to_port: 0
    protocol: -1
    source_sg: app_sg
  - rule_name: appegress
    description: 'APP egress'
    type: egress
    from_port: 0
    to_port: 0
    protocol: -1
    cidr_blocks:
    - 0.0.0.0/0
rds_migration_sg:
  description: Rds migration rules
  sg_rules:
  - rule_name: open22
    description: open port 22
    type: ingress
    from_port: 22
    to_port: 22
    protocol: tcp
    cidr_blocks:
    - 0.0.0.0/0
  - rule_name: rds_migrationegress
    description: All Egress ports
    type: egress
    from_port: 0
    to_port: 0
    protocol: -1
    cidr_blocks:
    - 0.0.0.0/0
  - rule_name: rdsbridge
    description: All Ingress from RDS BRIDGE INSTANCE
    type: ingress
    from_port: 0
    to_port: 0
    protocol: -1
    source_sg: rds_migration_sg
db_sg:
  description: db sg
  sg_rules:
  - rule_name: dbrds
    description: db rds
    type: ingress
    from_port: 1521
    to_port: 1521
    protocol: tcp
    source_sg: vpn_sg
  - rule_name: dbrdsself
    description: db rds self
    type: ingress
    from_port: 0
    to_port: 0
    protocol: -1
    source_sg: db_sg
  - rule_name: dbegress
    description: db egress
    type: egress
    from_port: 0
    to_port: 0
    protocol: -1
    cidr_blocks:
    - 0.0.0.0/0
  - rule_name: dbapp
    description: allow app_sg
    type: ingress
    from_port: 1521
    to_port: 1521
    protocol: tcp
    source_sg: app_sg
  - rule_name: db_rds_migration # this is imp rule
    description: allow all ports to rds migration
    type: ingress
    from_port: 0
    to_port: 0
    protocol: -1
    source_sg: rds_migration_sg
  - rule_name: openforVPN
    description: open ports to VPN
    type: ingress
    from_port: 0
    to_port: 0
    protocol: -1
    cidr_blocks:
    - 172.16.0.0/20

app_lb_sg:
  description: app loadbalancer sg
  sg_rules:
  - rule_name: openRDP
    description: open port 3389 for RDP
    type: ingress
    from_port: 3389
    to_port: 3389
    protocol: tcp
    cidr_blocks:
    - 0.0.0.0/0
  - rule_name: openHTTP
    description: open port 80
    type: ingress
    from_port: 80
    to_port: 80
    protocol: tcp
    cidr_blocks:
    - 0.0.0.0/0
  - rule_name: openHTTPS
    description: open port 443
    type: ingress
    from_port: 443
    to_port: 443
    protocol: tcp
    cidr_blocks:
    - 0.0.0.0/0
  - rule_name: open135TCP
    description: open port 135 TCP
    type: ingress
    from_port: 135
    to_port: 139
    protocol: tcp
    cidr_blocks:
    - 0.0.0.0/0
  - rule_name: open135UPD
    description: open port 135 UDP
    type: ingress
    from_port: 135
    to_port: 139
    protocol: udp
    cidr_blocks:
    - 0.0.0.0/0
  - rule_name: openAPPAdminPortal
    description: open APP Admin Portal
    type: ingress
    from_port: 9990
    to_port: 9990
    protocol: tcp
    cidr_blocks:
    - 0.0.0.0/0
  - rule_name: AppLBegress
    description: App LB egress
    type: egress
    from_port: 0
    to_port: 0
    protocol: -1
    cidr_blocks:
    - 0.0.0.0/0